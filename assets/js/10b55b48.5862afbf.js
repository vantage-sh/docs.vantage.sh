"use strict";(self.webpackChunkdocs_vantage_sh=self.webpackChunkdocs_vantage_sh||[]).push([[1086],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var s=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,s,o=function(e,t){if(null==e)return{};var a,s,o={},r=Object.keys(e);for(s=0;s<r.length;s++)a=r[s],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)a=r[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var n=s.createContext({}),u=function(e){var t=s.useContext(n),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=u(e.components);return s.createElement(n.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},g=s.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,n=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),g=o,m=p["".concat(n,".").concat(g)]||p[g]||d[g]||r;return a?s.createElement(m,l(l({ref:t},c),{},{components:a})):s.createElement(m,l({ref:t},c))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=g;var i={};for(var n in t)hasOwnProperty.call(t,n)&&(i[n]=t[n]);i.originalType=e,i[p]="string"==typeof e?e:o,l[1]=i;for(var u=2;u<r;u++)l[u]=a[u];return s.createElement.apply(null,l)}return s.createElement.apply(null,a)}g.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(7294),o=a(6010);const r={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:a,className:l}=e;return s.createElement("div",{role:"tabpanel",className:(0,o.Z)(r.tabItem,l),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>w});var s=a(7462),o=a(7294),r=a(6010),l=a(2466),i=a(6550),n=a(1980),u=a(7392),c=a(12);function p(e){return function(e){return o.Children.map(e,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:s,default:o}}=e;return{value:t,label:a,attributes:s,default:o}}))}function d(e){const{values:t,children:a}=e;return(0,o.useMemo)((()=>{const e=t??p(a);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function g(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:a}=e;const s=(0,i.k6)(),r=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,n._X)(r),(0,o.useCallback)((e=>{if(!r)return;const t=new URLSearchParams(s.location.search);t.set(r,e),s.replace({...s.location,search:t.toString()})}),[r,s])]}function h(e){const{defaultValue:t,queryString:a=!1,groupId:s}=e,r=d(e),[l,i]=(0,o.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!g({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const s=a.find((e=>e.default))??a[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:r}))),[n,u]=m({queryString:a,groupId:s}),[p,h]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,r]=(0,c.Nk)(a);return[s,(0,o.useCallback)((e=>{a&&r.set(e)}),[a,r])]}({groupId:s}),f=(()=>{const e=n??p;return g({value:e,tabValues:r})?e:null})();(0,o.useLayoutEffect)((()=>{f&&i(f)}),[f]);return{selectedValue:l,selectValue:(0,o.useCallback)((e=>{if(!g({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),h(e)}),[u,h,r]),tabValues:r}}var f=a(2389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:a,selectedValue:i,selectValue:n,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,l.o5)(),d=e=>{const t=e.currentTarget,a=c.indexOf(t),s=u[a].value;s!==i&&(p(t),n(s))},g=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":a},t)},u.map((e=>{let{value:t,label:a,attributes:l}=e;return o.createElement("li",(0,s.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>c.push(e),onKeyDown:g,onClick:d},l,{className:(0,r.Z)("tabs__item",v.tabItem,l?.className,{"tabs__item--active":i===t})}),a??t)})))}function b(e){let{lazy:t,children:a,selectedValue:s}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===s));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return o.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==s}))))}function y(e){const t=h(e);return o.createElement("div",{className:(0,r.Z)("tabs-container",v.tabList)},o.createElement(k,(0,s.Z)({},e,t)),o.createElement(b,(0,s.Z)({},e,t)))}function w(e){const t=(0,f.Z)();return o.createElement(y,(0,s.Z)({key:String(t)},e))}},7660:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>n,default:()=>m,frontMatter:()=>i,metadata:()=>u,toc:()=>p});var s=a(7462),o=(a(7294),a(3905)),r=a(4866),l=a(5162);const i={id:"virtual_tagging",name:"Virtual Tagging",description:"Create virtual tags within Vantage to provide a consistent tagging schema across cloud providers.",keywords:["Virtual tagging","Vantage tags"]},n="Virtual Tagging",u={unversionedId:"virtual_tagging",id:"virtual_tagging",title:"Virtual Tagging",description:"Create virtual tags within Vantage to provide a consistent tagging schema across cloud providers.",source:"@site/docs/virtual_tagging.md",sourceDirName:".",slug:"/virtual_tagging",permalink:"/virtual_tagging",draft:!1,editUrl:"https://github.com/vantage-sh/docs.vantage.sh/blob/master/docs/virtual_tagging.md",tags:[],version:"current",frontMatter:{id:"virtual_tagging",name:"Virtual Tagging",description:"Create virtual tags within Vantage to provide a consistent tagging schema across cloud providers.",keywords:["Virtual tagging","Vantage tags"]},sidebar:"someSidebar",previous:{title:"Workspaces",permalink:"/workspaces"},next:{title:"API",permalink:"/api"}},c={},p=[{value:"Virtual Tags vs. Saved Filters vs. Cost Allocation Segments",id:"virtual-tags-vs-saved-filters-vs-cost-allocation-segments",level:2},{value:"Custom Value Tags",id:"custom-value-tags",level:2},{value:"Cost-Based and Business Metrics-Based Allocation Tags",id:"cost-based-and-business-metrics-based-allocation-tags",level:2},{value:"Cost-Based Allocation Tags",id:"cost-based-allocation-tags",level:3},{value:"Business Metrics-Based Allocation Tags",id:"business-metrics-based-allocation-tags",level:3},{value:"Create Virtual Tags",id:"create-virtual-tags",level:2},{value:"Virtual Tag Order",id:"virtual-tag-order",level:3},{value:"Filter and Group by Virtual Tags",id:"filter-and-group-by-virtual-tags",level:2},{value:"Delete a Virtual Tag",id:"delete-a-virtual-tag",level:2},{value:"Virtual Tagging Examples",id:"examples",level:2},{value:"Custom Value Examples",id:"custom-values-example",level:3},{value:"Example 1: Cross-Provider Tagging",id:"example-1-cross-provider-tagging",level:4},{value:"Step 1: Create a New Tag",id:"step-1-create-a-new-tag",level:5},{value:"Step 2: Add Tag Values and Filters",id:"step-2-add-tag-values-and-filters",level:5},{value:"Example 2: Consolidate Existing Tags",id:"example-2-consolidate-existing-tags",level:4},{value:"Step 1: Create a New Tag",id:"step-1-create-a-new-tag-1",level:5},{value:"Step 2: Add Tag Values and Filters",id:"step-2-add-tag-values-and-filters-1",level:5},{value:"Cost-Based Allocation Example",id:"cost-based-allocation-example",level:3},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Step 1: Create a New Cost-Based Allocation Tag",id:"step-1-create-a-new-cost-based-allocation-tag",level:4},{value:"Step 2: Select an Input Cost Filter",id:"step-2-select-an-input-cost-filter",level:4},{value:"Step 3: Select a Tag Key",id:"step-3-select-a-tag-key",level:4},{value:"Step 4: Select an Output Cost Filter",id:"step-4-select-an-output-cost-filter",level:4},{value:"Business Metrics-Based Allocation Example",id:"metric-based-allocation-example",level:3},{value:"Prerequisite",id:"prerequisite",level:4},{value:"Step 1: Create a New Business Metrics-Based Allocation Tag",id:"step-1-create-a-new-business-metrics-based-allocation-tag",level:4},{value:"Step 2: Select the Labeled Business Metric",id:"step-2-select-the-labeled-business-metric",level:4},{value:"Step 3: Select an Output Cost Filter",id:"step-3-select-an-output-cost-filter",level:4}],d={toc:p},g="wrapper";function m(e){let{components:t,...a}=e;return(0,o.kt)(g,(0,s.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"virtual-tagging"},"Virtual Tagging"),(0,o.kt)("p",null,"You can create virtual tags to consistently tag costs across providers in Vantage. This feature can help to increase tagging coverage across your cloud infrastructure. Create cost allocation tag keys with a set of corresponding values and filters directly in the Vantage without needing to involve your engineering team in making infrastructure changes. All provider integrations in Vantage are supported, including providers that don't natively support tags."),(0,o.kt)("p",null,"Virtual tags are available for filtering and aggregating on all ",(0,o.kt)("a",{parentName:"p",href:"/cost_reports"},"Cost Reports")," and ",(0,o.kt)("a",{parentName:"p",href:"/segments"},"cost allocation segments"),". They can also be used in filter criteria on ",(0,o.kt)("a",{parentName:"p",href:"/saved_filters"},"saved filters"),". There is no limit to the number of tag keys or values you define."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"To get started with virtual tagging, you can also view a video demo on ",(0,o.kt)("a",{parentName:"p",href:"/vantage_university_cost_allocation"},"Vantage University")," \ud83c\udf93.")),(0,o.kt)("h2",{id:"virtual-tags-vs-saved-filters-vs-cost-allocation-segments"},"Virtual Tags vs. Saved Filters vs. Cost Allocation Segments"),(0,o.kt)("p",null,"Virtual tags can be considered foundational to the rest of the data within Vantage. They should remain fairly static, and changes should be considered delicate. These changes will flow across all data and apply to all workspaces. The most common tag keys will be items like team, cost center, and environment."),(0,o.kt)("p",null,"Segments can then be used to create different hierarchical views for tagged data. This feature is useful for breaking down the data by different perspectives, such as by cost center or by OPEX/CapEX."),(0,o.kt)("p",null,"Saved filters can then be used in a more ad-hoc fashion to add lenses on top of base data. For instance, you could create a saved filter just for ",(0,o.kt)("em",{parentName:"p"},"North America")," that standardizes a set of regions across providers and can be used by teams on their reports or dashboards without having to know the set of filters needed to create the list of regions. When new regions come online, it\u2019s easy to modify the saved filter to include this region."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"If you want to transition any of your cost allocation segments to virtual tags, contact ",(0,o.kt)("a",{parentName:"p",href:"mailto:support@vantage.sh"},"support@vantage.sh"),".")),(0,o.kt)("h2",{id:"custom-value-tags"},"Custom Value Tags"),(0,o.kt)("p",null,"With custom value tags, you can create new cross-provider cost allocation tags to help better your tagging strategy. For example, you may have a series of resource tags, by product, across each of your providers. You can create custom tags in Vantage to combine those costs into one unique product tag for all resources in that product group."),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/virtual_tagging#custom-values-example"},"example section")," below for details."),(0,o.kt)("h2",{id:"cost-based-and-business-metrics-based-allocation-tags"},"Cost-Based and Business Metrics-Based Allocation Tags"),(0,o.kt)("p",null,"The cost-based and business metrics-based allocation tag types allow for ",(0,o.kt)("em",{parentName:"p"},"dynamic cost allocation"),", which is the process of allocating costs based on another existing cost or metric. See the below video for an introduction to dynamic cost allocation."),(0,o.kt)("div",{style:{position:"relative",width:"100%",paddingBottom:"56.25%",height:"0",overflow:"hidden"}},(0,o.kt)("iframe",{src:"https://www.youtube.com/embed/67RbHPtfgEE?si=3J14Pjwos6ubUdSd?rel=0&color=white&modestbranding=1&wmode=transparent&autoplay=1",allowFullScreen:!0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",borderRadius:"10px"}})),(0,o.kt)("h3",{id:"cost-based-allocation-tags"},"Cost-Based Allocation Tags"),(0,o.kt)("p",null,"With cost-based allocation tags, you can create a dynamically allocated cost structure. Select a set of input costs (e.g., all AWS costs), an existing cost tag to use for allocation (e.g., a teams cost tag), and an output cost (e.g, a static cost, like AWS Support) that you want to be allocated the same way as your input cost."),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/virtual_tagging#cost-based-allocation-example"},"example section")," below for details."),(0,o.kt)("h3",{id:"business-metrics-based-allocation-tags"},"Business Metrics-Based Allocation Tags"),(0,o.kt)("p",null,"With business metrics-based allocation tags, you select an existing ",(0,o.kt)("a",{parentName:"p",href:"/per_unit_costs"},"business metric")," (e.g., CPU use per product) and indicate your output cost (e.g., all GCP Compute costs) so that the allocation of the output cost mimics the percentage allocation of the existing business metric."),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/virtual_tagging#metric-based-allocation-example"},"example section")," below for details."),(0,o.kt)("h2",{id:"create-virtual-tags"},"Create Virtual Tags"),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"This feature requires ",(0,o.kt)("em",{parentName:"p"},"Owner")," permissions in Vantage. See the ",(0,o.kt)("a",{parentName:"p",href:"/rbac"},"Role-Based Access Control")," documentation for details. Virtual tags apply to all ",(0,o.kt)("a",{parentName:"p",href:"/workspaces"},"workspaces"),".")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"From the top navigation, click ",(0,o.kt)("strong",{parentName:"p"},"Settings"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"From the side navigation, under ",(0,o.kt)("strong",{parentName:"p"},"General Settings"),", click ",(0,o.kt)("strong",{parentName:"p"},"Virtual Tags"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"All existing virtual tags are displayed alphabetically. You can edit and delete any existing tags from this screen. To add a new virtual tag, click ",(0,o.kt)("strong",{parentName:"p"},"Create a Virtual Tag"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter a title for the ",(0,o.kt)("strong",{parentName:"p"},"Tag Key"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Billing Period Backfill"),", select a billing period (e.g., ",(0,o.kt)("strong",{parentName:"p"},"Apr 2024"),") for which the tag should be backfilled.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enable the ",(0,o.kt)("strong",{parentName:"p"},"Can Override")," toggle if you want the virtual tag to override an existing service cost value. For example, if you create a virtual tag that conflicts with an existing provider tag, this option will override the existing provider tag key in Vantage reports.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Values")," section, click ",(0,o.kt)("strong",{parentName:"p"},"+Add"),". Select whether you want to create a ",(0,o.kt)("strong",{parentName:"p"},"Custom Value"),", ",(0,o.kt)("strong",{parentName:"p"},"Business Metric"),", or ",(0,o.kt)("strong",{parentName:"p"},"Cost Based")," value. Click through the tabs below for instructions on each value type."),(0,o.kt)(r.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"custom",label:"Add Custom Value",default:!0,mdxType:"TabItem"},(0,o.kt)("ol",null,(0,o.kt)("li",null,"Click ",(0,o.kt)("strong",null,"Assign Custom Value"),"."),(0,o.kt)("li",null,"Enter a ",(0,o.kt)("strong",null,"Tag Value")," title. Titles can contain only letters, numbers, and the following characters: ",(0,o.kt)("code",null,"\\_ - & + , . : / \\"),". You cannot use saved filters to define a virtual tag value's filters."),(0,o.kt)("li",null,"Specify the tag value's filter criteria. These filters function just like filters on Cost Reports and cost allocation segments. For information on how to create detailed filters, see the\xa0",(0,o.kt)("a",{href:"/cost_reports"},"Cost Reports"),"\xa0documentation."))),(0,o.kt)(l.Z,{value:"business",label:"Add Business Metric Value",default:!0,mdxType:"TabItem"},(0,o.kt)("ol",null,(0,o.kt)("li",null,"Click ",(0,o.kt)("strong",null,"Connect a Business Metric"),"."),(0,o.kt)("li",null,"Select an existing ",(0,o.kt)("a",{href:"/per_unit_costs"},"business metric"),"."),(0,o.kt)("li",null,"Select the ",(0,o.kt)("strong",null,"Output Costs Filter")," that will be split among your tag values based on your business metric. These filters function just like filters on Cost Reports and cost allocation segments. For information on how to create detailed filters, see the\xa0",(0,o.kt)("a",{href:"/cost_reports"},"Cost Reports"),"\xa0documentation."))),(0,o.kt)(l.Z,{value:"cost",label:"Add Cost Based Value",default:!0,mdxType:"TabItem"},(0,o.kt)("ol",null,(0,o.kt)("li",null,"Select ",(0,o.kt)("strong",null,"Cost Based"),"."),(0,o.kt)("li",null,"Select an ",(0,o.kt)("strong",null,"Input Costs Filter")," to specify which category of input costs to include in the allocation. These filters function just like filters on Cost Reports and cost allocation segments. For information on how to create detailed filters, see the\xa0",(0,o.kt)("a",{href:"/cost_reports"},"Cost Reports"),"\xa0documentation."),(0,o.kt)("li",null,"Select an existing cost ",(0,o.kt)("strong",null,"Tag Key"),". This value is an existing tag you have in one of your cost providers, like AWS."),(0,o.kt)("li",null,"Select the ",(0,o.kt)("strong",null,"Output Costs Filter")," to indicate the costs that will be split among your tag values based on your input cost filter.")))),(0,o.kt)("hr",{parentName:"li"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"At the top, click ",(0,o.kt)("strong",{parentName:"p"},"Save"),"."))),(0,o.kt)("p",null,"Processing tag changes usually takes under an hour. At the top of the ",(0,o.kt)("strong",{parentName:"p"},"Virtual Tags")," screen, the processing status is displayed. Processing times vary based on the number of tags and volume of data you have imported into Vantage."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"The Virtual Tag screen with a processing status displayed for Fastly and New Relic",width:"80%",src:"/img/virtual-tag-status.png"})),(0,o.kt)("h3",{id:"virtual-tag-order"},"Virtual Tag Order"),(0,o.kt)("p",null,"Tag values are arranged in priority order on the ",(0,o.kt)("strong",{parentName:"p"},"Virtual Tags")," screen. You can move tag values up and down in the UI to reorder them, as demonstrated in the visual example below."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center",boxShadow:"0 0 10px rgba(0, 0, 0, 0.2)",borderRadius:"10px",overflow:"hidden"}},(0,o.kt)("img",{alt:"GIF of two tag values, staging and production, being reordered in the Tags UI",width:"80%",src:"/img/reorder-tags.gif"})),(0,o.kt)("br",null),(0,o.kt)("p",null,"When cost data is ingested into Vantage, the first value that matches the corresponding filters will be applied to that line item. In cases where filters overlap, the order of tag values within each key determines the value that is applied."),(0,o.kt)("h2",{id:"filter-and-group-by-virtual-tags"},"Filter and Group by Virtual Tags"),(0,o.kt)("p",null,"You can filter by virtual tags in Cost Reports, cost allocation segments, and when creating saved filters. Virtual tags are visible along with your existing provider tags. Use the ",(0,o.kt)("strong",{parentName:"p"},"Tag")," (",(0,o.kt)("strong",{parentName:"p"},"Label")," in GCP) filter and grouping option."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A Cost Report filter with two filters applied: one for AWS costs for the team/data tag and one for GCP costs with the same tag",width:"80%",src:"/img/virtual-tag-consolidate-report.png"})),(0,o.kt)("h2",{id:"delete-a-virtual-tag"},"Delete a Virtual Tag"),(0,o.kt)("p",null,"To delete a virtual tag, navigate to the ",(0,o.kt)("a",{parentName:"p",href:"https://console.vantage.sh/settings/virtual_tags"},"Virtual Tags")," page. All existing tag keys are displayed. Click the trashcan icon next to a tag key. Your data will be re-tagged, excluding the deleted virtual tag, going back to the deleted tag\u2019s backfill bill period. Newly ingested data will no longer be tagged with the deleted tag."),(0,o.kt)("h2",{id:"examples"},"Virtual Tagging Examples"),(0,o.kt)("p",null,"The following examples demonstrate how to use virtual tagging in a multi-provider organization."),(0,o.kt)("h3",{id:"custom-values-example"},"Custom Value Examples"),(0,o.kt)("h4",{id:"example-1-cross-provider-tagging"},"Example 1: Cross-Provider Tagging"),(0,o.kt)("p",null,"You want to create a tag mapping for each of your teams that maps corresponding teams with certain services and provider accounts."),(0,o.kt)("h5",{id:"step-1-create-a-new-tag"},"Step 1: Create a New Tag"),(0,o.kt)("p",null,"You create a tag key called ",(0,o.kt)("inlineCode",{parentName:"p"},"Teams"),"."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"The Tag Key field displayed in the Virtual Tags UI; the name Teams is entered",width:"80%",src:"/img/virtual-provider-tag-key.png"})),(0,o.kt)("h5",{id:"step-2-add-tag-values-and-filters"},"Step 2: Add Tag Values and Filters"),(0,o.kt)("p",null,"You add the corresponding set of virtual tag values and filters:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"data")," team tag value corresponds with a filter for all costs for GCP BigQuery and Amazon Redshift."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"mobile")," team tag value corresponds with a filter for its related GCP projects and AWS accounts."),(0,o.kt)("li",{parentName:"ul"},"You continue this pattern and create similar values with corresponding filters for your other teams.")),(0,o.kt)("div",{style:{display:"flex",overflow:"scroll"}},(0,o.kt)("img",{alt:"A sample Tag Value field for a value of data with filter for Service of BigQuery and Amazon Redshift",width:"60%",src:"/img/virtual-tag-provider-value-1.png"}),(0,o.kt)("img",{alt:"A sample Tag Value field for a value of data with a filter for GCP Project of mobile and AWS account of mobile",width:"60%",src:"/img/virtual-tag-provider-value-2.png"})),(0,o.kt)("p",null,"Within Cost Reports, you can easily filter and group by these tag options to easily see costs for an individual team. In the below visual example, the Cost Report is grouped by the ",(0,o.kt)("strong",{parentName:"p"},"team")," tag, and the ",(0,o.kt)("strong",{parentName:"p"},"mobile")," and ",(0,o.kt)("strong",{parentName:"p"},"data")," values are displayed along with the other team tag values you created."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Cost Report grouped by Tag showing a mobile and data tag",width:"100%",src:"/img/virtual-tag-provider-report.png"})),(0,o.kt)("h4",{id:"example-2-consolidate-existing-tags"},"Example 2: Consolidate Existing Tags"),(0,o.kt)("p",null,"You have a tagging practice established at your organization, but teams often create tags with spelling variations, tags with typos, or they create duplicate tags. For example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," team has resources tagged with ",(0,o.kt)("inlineCode",{parentName:"p"},"data"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Data"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"data-prod"),". This is an issue across many of your teams. You want to consolidate all these tags, across providers, into one ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," tag."),(0,o.kt)("h5",{id:"step-1-create-a-new-tag-1"},"Step 1: Create a New Tag"),(0,o.kt)("p",null,"You create a tag key called ",(0,o.kt)("inlineCode",{parentName:"p"},"Teams")," to override existing tags."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"The Tag Key field displayed in the Virtual Tags UI; the name Teams is entered",width:"80%",src:"/img/virtual-provider-tag-key.png"})),(0,o.kt)("h5",{id:"step-2-add-tag-values-and-filters-1"},"Step 2: Add Tag Values and Filters"),(0,o.kt)("p",null,"You add the corresponding set of virtual tag values and filters. In this example, all permutations of the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," team tag are combined into one virtual tag."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Tag Value field for a value of AWS team tags equaling data, data-prod, and Data. Another value for a GCP team Label equaling data",width:"80%",src:"/img/virtual-tag-consolidate-value.png"})),(0,o.kt)("p",null,"Within Cost Reports, you can easily filter by this tag to see all costs related to the ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," team. This saves you the work of needing to always filter for all permutations of this tag. Now, you need to filter by only one tag."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A Cost Report with a filter for AWS and GCP team tag of data",width:"80%",src:"/img/virtual-tag-consolidate-report.png"})),(0,o.kt)("h3",{id:"cost-based-allocation-example"},"Cost-Based Allocation Example"),(0,o.kt)("p",null,"In your organization, teams share resources, such as RDS databases or EC2 instances, and each team consumes different percentages of these resources each month. Your organization is also charged a static support fee each month for AWS. As shown in the diagram below, you want to allocate a portion of the support fee to each team based on their proportional use of AWS resources. So in the below example, since the Infra team is responsible for 50% of all AWS costs, they should also be responsible for 50% of the support fee. You can create a cost-based allocation virtual tag for allocating portions of the support fee to each respective team."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A flowchart that has the AWS logo in a block at the top. AWS has three arrows pointing to tag icons that say Infra 50%, Mobile 20%, and Data 30%. These tags point to a box that says Dynamic Cost Allocation with the icon for AWS Support. This box has three arrows that point to three boxes. The boxes say Infra Team AWS Support Costs 50%, Mobile Team AWS Support Costs 20%, and Data Team AWS Support Costs 30%.",width:"60%",src:"/img/cost-based-example.png"})),(0,o.kt)("h4",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"You have an existing provider tag in AWS that identifies resources for your teams. This tag will be used in step 2."),(0,o.kt)("h4",{id:"step-1-create-a-new-cost-based-allocation-tag"},"Step 1: Create a New Cost-Based Allocation Tag"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Navigate to ",(0,o.kt)("strong",{parentName:"li"},"Settings > Virtual Tags"),"."),(0,o.kt)("li",{parentName:"ul"},"Create a new virtual tag."),(0,o.kt)("li",{parentName:"ul"},"Select the ",(0,o.kt)("strong",{parentName:"li"},"Cost-Based")," option for the tag value.")),(0,o.kt)("h4",{id:"step-2-select-an-input-cost-filter"},"Step 2: Select an Input Cost Filter"),(0,o.kt)("p",null,"For your input cost, select ",(0,o.kt)("strong",{parentName:"p"},"All AWS Costs"),"."),(0,o.kt)("h4",{id:"step-3-select-a-tag-key"},"Step 3: Select a Tag Key"),(0,o.kt)("p",null,"You select your existing ",(0,o.kt)("strong",{parentName:"p"},"teams")," tag key you have in AWS that will be used for allocating costs."),(0,o.kt)("h4",{id:"step-4-select-an-output-cost-filter"},"Step 4: Select an Output Cost Filter"),(0,o.kt)("p",null,"In this example, since your infrastructure team is responsible for 50% of all AWS costs, the mobile team for 20%, and the data team for 30%, you can mimic this allocation across another static cost, or your output cost. Select the filters for the AWS support fee."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Tag Value field for AWS Support Fee costs",width:"70%",src:"/img/virtual-tag-support-fee.png"})),(0,o.kt)("p",null,"Once the tag is created, create a new Cost Report and add the following criteria:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a filter for AWS Support costs."),(0,o.kt)("li",{parentName:"ul"},"Add grouping criteria to group by your new cost-based dynamic allocation tag.")),(0,o.kt)("p",null,"The resulting report shows how much of the support fee each team is allocated."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Tag Value field for AWS Support Fee costs",width:"100%",src:"/img/virtual-tag-support-fee-report.png"})),(0,o.kt)("h3",{id:"metric-based-allocation-example"},"Business Metrics-Based Allocation Example"),(0,o.kt)("p",null,"You are working with your infrastructure team and want to ensure that the proportional cost of CPU time on a shared resource is allocated to the distinct cost centers that are consuming the CPU. In the below example, you want each team\u2019s portion of CPU usage billed as a corresponding percentage of the overall Namespace CPU cost. So, if Team A uses 30% of the resource\u2019s CPU, then they should be billed a proportional percentage of the total Namespace\u2019s costs."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A flowchart that has a CPU icon in a block at the top and says Shared Resource CPU. CPU has two arrows pointing to two boxes with people icons that say Team A CPU Usage and Team B CPU Usage. These boxes point to a box that says Total Namespace Costs with the Kubernetes icon. This box has two arrows that point to two boxes that say Portion of Namespace Costs Allocated to Team Based on Portion of CPU Usage.",width:"60%",src:"/img/metric-based-example.png"})),(0,o.kt)("h4",{id:"prerequisite"},"Prerequisite"),(0,o.kt)("p",null,"To determine the cost of CPU time to allocate to each respective team, you first create a ",(0,o.kt)("a",{parentName:"p",href:"/per_unit_costs/#labels"},"labeled business metric")," that includes the CPU time labeled by team. Vantage then calculates the respective percentage of CPU time for each team. The labeled business metric has the following format."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"date,amount,label\n2024-01-09,825,teama\n2024-01-09,600,teamb\n2024-01-10,500,teama\n2024-01-10,200,teamb\n2024-01-11,723,teama\n2024-01-11,456,teamb\n")),(0,o.kt)("h4",{id:"step-1-create-a-new-business-metrics-based-allocation-tag"},"Step 1: Create a New Business Metrics-Based Allocation Tag"),(0,o.kt)("p",null,"You create a new business metrics-based tag:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Navigate to ",(0,o.kt)("strong",{parentName:"li"},"Settings > Virtual Tags"),"."),(0,o.kt)("li",{parentName:"ul"},"Create a new virtual tag."),(0,o.kt)("li",{parentName:"ul"},"Select the ",(0,o.kt)("strong",{parentName:"li"},"Business Metric")," option for the tag value.")),(0,o.kt)("h4",{id:"step-2-select-the-labeled-business-metric"},"Step 2: Select the Labeled Business Metric"),(0,o.kt)("p",null,"Search for and select the labeled business metric you just created to use for allocation."),(0,o.kt)("h4",{id:"step-3-select-an-output-cost-filter"},"Step 3: Select an Output Cost Filter"),(0,o.kt)("p",null,"Select the Vantage costs that will be split based on the percentages calculated in your business metric. In this case, you select a filter to show costs for the specific Namespace you want to be allocated."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Tag Value field for specific Kubernetes namespace costs",width:"90%",src:"/img/virtual-tag-metric.png"})),(0,o.kt)("p",null,"Once the tag is created, create a new Cost Report and add the following criteria:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a filter for the specific Namespace."),(0,o.kt)("li",{parentName:"ul"},"Add grouping criteria to group by your new business metrics-based dynamic allocation tag.")),(0,o.kt)("p",null,"The resulting report shows how much of the Namespace costs each team is allocated."),(0,o.kt)("div",{style:{display:"flex",justifyContent:"center"}},(0,o.kt)("img",{alt:"A sample Tag Value field for AWS Support Fee costs",width:"100%",src:"/img/virtual-tag-metric-report.png"})))}m.isMDXComponent=!0}}]);