"use strict";(self.webpackChunkdocs_vantage_sh=self.webpackChunkdocs_vantage_sh||[]).push([[2606],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(a),d=o,m=u["".concat(p,".").concat(d)]||u[d]||g[d]||r;return a?n.createElement(m,i(i({ref:t},c),{},{components:a})):n.createElement(m,i({ref:t},c))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var s=2;s<r;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6252:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>g,frontMatter:()=>r,metadata:()=>l,toc:()=>s});var n=a(7462),o=(a(7294),a(3905));const r={id:"enabling_gcp_billing_export",title:"Configure GCP Billing Exports",description:"This page walks through how to enable GCP Billing exports, which are a prerequisite to connecting GCP with your Vantage account.",keywords:["GCP","Google Cloud Platform","GCP Billing Exports"]},i="Configure GCP Billing Exports",l={unversionedId:"enabling_gcp_billing_export",id:"enabling_gcp_billing_export",title:"Configure GCP Billing Exports",description:"This page walks through how to enable GCP Billing exports, which are a prerequisite to connecting GCP with your Vantage account.",source:"@site/docs/enabling_gcp_billing_export.md",sourceDirName:".",slug:"/enabling_gcp_billing_export",permalink:"/enabling_gcp_billing_export",draft:!1,editUrl:"https://github.com/vantage-sh/docs.vantage.sh/blob/master/docs/enabling_gcp_billing_export.md",tags:[],version:"current",frontMatter:{id:"enabling_gcp_billing_export",title:"Configure GCP Billing Exports",description:"This page walks through how to enable GCP Billing exports, which are a prerequisite to connecting GCP with your Vantage account.",keywords:["GCP","Google Cloud Platform","GCP Billing Exports"]},sidebar:"someSidebar",previous:{title:"Set Up Google Cloud",permalink:"/connecting_gcp"},next:{title:"Set Up Kubernetes",permalink:"/connecting_kubernetes"}},p={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Create a Billing Export",id:"create-a-billing-export",level:2},{value:"Step 1: Select or Create a Project",id:"step-1-select-or-create-a-project",level:3},{value:"Step 2: Create a BigQuery Dataset",id:"step-2-create-a-bigquery-dataset",level:3},{value:"Step 3: Enable Cloud Billing Export to the BigQuery Dataset",id:"step-3-enable-cloud-billing-export-to-the-bigquery-dataset",level:3},{value:"Next Steps: Complete Your Vantage-GCP Integration",id:"next-steps-complete-your-vantage-gcp-integration",level:2}],c={toc:s},u="wrapper";function g(e){let{components:t,...a}=e;return(0,o.kt)(u,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"configure-gcp-billing-exports"},"Configure GCP Billing Exports"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"This below documentation is a streamlined version of ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.google.com/billing/docs/how-to/export-data-bigquery-setup"},"Google Cloud Platform's official documentation"),".")),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"Before you begin, ensure you have the following permissions configured. See the ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.google.com/billing/docs/how-to/export-data-bigquery-setup#required_permissions"},"Google Cloud Platform documentation")," for information on how to configure these permissions."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"User with permissions to create a project"),(0,o.kt)("li",{parentName:"ul"},"User with permissions to create a BigQuery dataset"),(0,o.kt)("li",{parentName:"ul"},"User with permissions to modify Billing settings")),(0,o.kt)("h2",{id:"create-a-billing-export"},"Create a Billing Export"),(0,o.kt)("h3",{id:"step-1-select-or-create-a-project"},"Step 1: Select or Create a Project"),(0,o.kt)("p",null,"Before you enable Cloud Billing data exports, you will need to create a project to store the data. If you have multiple Cloud Billing accounts, you will need to enable Cloud Billing exports, individually, on each account."),(0,o.kt)("admonition",{title:"Recommendation",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"We recommend you create a dedicated project to store all Cloud Billing data, rather than using an existing project.")),(0,o.kt)("p",null,"The project needs to be linked to the same Cloud Billing account that you plan to enable the Cloud Billing data export on. If you need help assigning a project to a Cloud Billing account, follow the  ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.google.com/billing/docs/how-to/modify-project#confirm_billing_is_enabled_on_a_project"},"Cloud Billing documentation"),"."),(0,o.kt)("h3",{id:"step-2-create-a-bigquery-dataset"},"Step 2: Create a BigQuery Dataset"),(0,o.kt)("p",null,"In the GCP console, navigate to ",(0,o.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/bigquery"},"BigQuery"),", and follow the steps below to create a BigQuery dataset."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"From the ",(0,o.kt)("strong",{parentName:"p"},"Project")," dropdown list at the top of the BigQuery console, select the project you set up for your Cloud Billing data export.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Explorer")," panel, click the ",(0,o.kt)("strong",{parentName:"p"},"three vertical dots")," (next to your project ID).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Create dataset"),"."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Expand to view example image"),(0,o.kt)("div",null,(0,o.kt)("img",{alt:"Create BigQuery dataset menu",width:"80%",src:"/img/connect-gcp/gcp-project-create-dataset.png"})," "))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Configure your dataset:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Enter a ",(0,o.kt)("strong",{parentName:"p"},"Dataset ID"),". We recommend an ID that spans projects, such as ",(0,o.kt)("em",{parentName:"p"},"all_billing_data"),", rather than a project-specific ID.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Location type"),", select either ",(0,o.kt)("strong",{parentName:"p"},"US (multiple regions in United States)")," or ",(0,o.kt)("strong",{parentName:"p"},"EU (multiple regions in European Union)"),". One of these two options is required to enable detailed usage cost data.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Leave the ",(0,o.kt)("strong",{parentName:"p"},"Enable table expiration")," checkbox unchecked to ensure that data never expires.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Click ",(0,o.kt)("strong",{parentName:"p"},"Advanced options"),". Set ",(0,o.kt)("strong",{parentName:"p"},"Encryption")," to ",(0,o.kt)("strong",{parentName:"p"},"Google-managed encryption key"),"."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Expand to view example image"),(0,o.kt)("div",null,(0,o.kt)("img",{alt:"Create BigQuery dataset",width:"80%",src:"/img/connect-gcp/gcp-create-dataset.png"})," ")))),(0,o.kt)("admonition",{parentName:"li",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Customer-managed key encryption is not supported for exporting Cloud Billing data records to BigQuery."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click the ",(0,o.kt)("strong",{parentName:"p"},"CREATE DATASET"),". You should see the dataset displayed in the ",(0,o.kt)("strong",{parentName:"p"},"Explorer")," panel, under your project."))),(0,o.kt)("h3",{id:"step-3-enable-cloud-billing-export-to-the-bigquery-dataset"},"Step 3: Enable Cloud Billing Export to the BigQuery Dataset"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Still in BigQuery, click the hamburger menu (three horizontal lines) at the top left of the console, and select ",(0,o.kt)("strong",{parentName:"p"},"Billing"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the left ",(0,o.kt)("strong",{parentName:"p"},"Billing navigation menu"),", select ",(0,o.kt)("strong",{parentName:"p"},"Billing export"),". (You can also search for and navigate to ",(0,o.kt)("strong",{parentName:"p"},"Billing export")," from the main search bar at the top of the GCP console.)")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Ensure you are on the ",(0,o.kt)("strong",{parentName:"p"},"BIGQUERY EXPORT")," tab. (This tab should be selected by default). Then, under ",(0,o.kt)("strong",{parentName:"p"},"Detailed usage cost"),", click ",(0,o.kt)("strong",{parentName:"p"},"EDIT SETTINGS"),"."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Expand to view example image"),(0,o.kt)("div",null,(0,o.kt)("img",{alt:"Create GCP Billing Export",width:"80%",src:"/img/connect-gcp/gcp-billing-export.png"})," "))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Configure the following settings:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"From the ",(0,o.kt)("strong",{parentName:"p"},"Projects")," list, select the project you set up to contain your billing data.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Dataset"),", select the dataset that you set up to contain your exported Cloud Billing data (e.g., ",(0,o.kt)("strong",{parentName:"p"},"all_billing_data"),")."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Expand to view example image"),(0,o.kt)("div",null,(0,o.kt)("img",{alt:"GCP detailed usage cost configuration",width:"80%",src:"/img/connect-gcp/gcp-detailed-usage-cost.png"})," "))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Click the ",(0,o.kt)("strong",{parentName:"p"},"SAVE"),"."))),(0,o.kt)("h2",{id:"next-steps-complete-your-vantage-gcp-integration"},"Next Steps: Complete Your Vantage-GCP Integration"),(0,o.kt)("p",null,"Your Cloud Billing data will start to be stored in the BigQuery dataset you created. To continue connecting your GCP account to Vantage, complete the ",(0,o.kt)("a",{parentName:"p",href:"/connecting_gcp/#create-a-connection"},"Create a GCP Connection")," instructions."),(0,o.kt)("admonition",{title:"Important",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"It typically takes a few hours for data to start appearing. Cloud Billing data is added retroactively for the current and previous month when detailed usage cost data is configured. Full data for the current and previous month can take 24\u201348 hours to fully propagate.")))}g.isMDXComponent=!0}}]);